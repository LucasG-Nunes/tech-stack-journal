<div
  class="modal-overlay"
  [class.is-maximized]="isMaximized"
  (click)="close()"
  (keydown.escape)="close()"
  tabindex="0"
  role="button"
  aria-label="Fechar modal">
  <div
    class="modal-content"
    [class.maximized-mode]="isMaximized"
    (click)="$event.stopPropagation()"
    (keydown.escape)="close()"
    tabindex="-1"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
    appScrollReveal>
    <header class="modal-header">
      <div class="header-top">
        <div class="left-actions">
          <div class="type-badge">{{ projectData.type }}</div>
          <button
            class="expand-btn"
            (click)="toggleMaximize()"
            type="button"
            [title]="isMaximized ? 'Minimizar' : 'Expandir (F11)'"
            aria-label="Alternar tela cheia">
            <span class="icon" aria-hidden="true">{{ isMaximized ? '‚ùê' : '‚õ∂' }}</span>
          </button>
        </div>
        <div class="floating-icon" aria-hidden="true">üöÄ</div>
      </div>
      <h1 id="modal-title" class="modal-title">{{ projectData.title | transloco }}</h1>
    </header>

    <div class="modal-body custom-scroll">
      <div class="project-preview" [class]="projectData.gradientClass">
        <div class="preview-overlay"></div>
        <img [src]="projectData.imageUrl" [alt]="projectData.title" class="modal-project-logo" />
      </div>

      <div class="project-content">
        <p class="description">{{ projectData.description | transloco }}</p>

        @if (isMaximized) {
        <div class="extra-details">
          <div class="divider"></div>

          <h3>Technical Deep Dive</h3>
          <div class="deep-dive-card">
            <p class="rich-text" [innerHTML]="'PROJECTS.ITEMS.' + getProjectKey() + '.DEEP_DIVE' | transloco"></p>
          </div>

          @if (projectLinks; as links) {
          <div class="resources-section">
            <h3>{{ 'PROJECTS.MODAL.LINKS_TITLE' | transloco }}</h3>
            <div class="links-grid">
              @for (link of links; track link.URL) { @if (link.LABEL) {
              <a [href]="link.URL" target="_blank" class="resource-link">
                <span class="link-icon">üîó</span>
                <span class="link-label">{{ link.LABEL }}</span>
              </a>
              } }
            </div>
          </div>
          } @if (projectImages; as images) {
          <div class="resources-section">
            <h3>{{ 'PROJECTS.MODAL.METRICS_TITLE' | transloco }}</h3>
            <div class="images-gallery">
              @for (img of images; track img.URL) {
              <div class="evidence-card" (click)="openImagePreview(img.URL)" tabindex="0" (keydown.enter)="openImagePreview(img.URL)">
                <div class="image-wrapper">
                  <img [src]="img.URL" [alt]="img.CAPTION" loading="lazy" />
                </div>
                <p class="image-caption">{{ img.CAPTION }}</p>
              </div>
              }
            </div>
          </div>
          }
        </div>
        }
      </div>
    </div>

    <footer class="modal-footer">
      <button class="close-btn" (click)="close()" type="button">{{ 'SHARED.MODAL_CONSTRUCTION.BUTTON' | transloco }}</button>
    </footer>



  @if (selectedImage) {
  <div class="image-upscale-overlay" (click)="closeImagePreview()" tabindex="0" (keydown.enter)="closeImagePreview()" role="button">
    <div class="close-preview">‚úï</div>
    <img [src]="selectedImage" class="upscaled-image" [alt]="'imagem selecionadda'" />
  </div>
  }

  </div>

</div>
